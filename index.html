<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FunTime Chat</title>
  <style>
    :root{--bg1:#73d0ff;--bg2:#09a8ff;--card:#ffffff;--accent:#0099ee}
    body{
      margin:0; font-family:Arial, Helvetica, sans-serif;
      background: linear-gradient(180deg,var(--bg1),var(--bg2));
      min-height:100vh; display:flex; justify-content:center; align-items:flex-start;
      padding:30px 12px;
    }
    .card{width:100%;max-width:420px;background:var(--card);border-radius:14px;padding:18px;box-shadow:0 6px 20px rgba(0,0,0,0.12)}
    .header{display:flex;gap:12px;align-items:center;margin-bottom:10px}
    .logo{width:64px;height:64px;border-radius:12px;background:linear-gradient(180deg,#bfeaff,#4fc3ff);display:flex;align-items:center;justify-content:center;font-weight:800;color:#00324d;font-size:28px}
    h1{margin:0;font-size:22px;color:#044;}
    label{display:block;color:#0a6;padding-top:8px;font-weight:600}
    input[type=text]{width:100%;padding:10px;border-radius:8px;border:1px solid #ddd;margin-top:8px;box-sizing:border-box}
    .row{display:flex;gap:10px;margin-top:12px}
    .btn{flex:1;padding:11px;border-radius:10px;background:#fff;border:1px solid #dcdcdc;cursor:pointer;font-weight:700}
    .btn-primary{background:linear-gradient(90deg,var(--bg1),var(--bg2));color:#fff;border:none;box-shadow:0 6px 12px rgba(9,148,255,0.18)}
    .chatbox{height:360px;background:#f8fbff;border-radius:10px;margin-top:14px;padding:12px;overflow:auto;border:1px solid #eee}
    .msg{padding:8px 10px;border-radius:8px;margin-bottom:8px;background:#fff;box-shadow:0 1px 0 rgba(0,0,0,0.03)}
    .small{font-size:12px;color:#666;margin-top:8px}
  </style>
</head>
<body>
  <div class="card">
    <div class="header">
      <div class="logo" id="logo">FT</div>
      <div>
        <h1>FunTime Chat</h1>
        <div style="color:#666;font-size:13px">Public Chat Â· Live</div>
      </div>
    </div>

    <label>Enter nickname</label>
    <input id="nick" type="text" placeholder="Type nickname">

    <div class="row">
      <button id="joinBtn" class="btn btn-primary">Save Name</button>
      <button id="clearBtn" class="btn">Clear</button>
    </div>

    <div id="chat" class="chatbox"></div>

    <div style="display:flex;gap:8px;margin-top:10px">
      <input id="msg" type="text" placeholder="Type message" style="flex:1;padding:10px;border-radius:8px;border:1px solid #ddd">
      <button id="send" class="btn btn-primary" style="width:110px">Send</button>
    </div>
  </div>

  <script type="module">
    // Firebase
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyB__tJ3sv3cB2N3vKHFCv8SYngJENQxwhY",
      authDomain: "funtimechat69-39947.firebaseapp.com",
      projectId: "funtimechat69-39947",
      storageBucket: "funtimechat69-39947.firebasestorage.app",
      messagingSenderId: "559638056734",
      appId: "1:559638056734:web:9329d2b561b6fab106830f",
      databaseURL: "https://funtimechat69-39947-default-rtdb.firebaseio.com"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const chatRef = ref(db, "messages");

    const nickEl = document.getElementById("nick");
    const msgEl = document.getElementById("msg");
    const chatEl = document.getElementById("chat");
    const sendBtn = document.getElementById("send");
    const joinBtn = document.getElementById("joinBtn");
    const clearBtn = document.getElementById("clearBtn");

    // Save nickname
    joinBtn.onclick = ()=>{ localStorage.setItem("nickname", nickEl.value.trim()); alert("Saved!"); };
    clearBtn.onclick = ()=>{ localStorage.removeItem("nickname"); nickEl.value=""; };

    nickEl.value = localStorage.getItem("nickname") || "";

    // Send Message
    sendBtn.onclick = ()=>{
      const text = msgEl.value.trim();
      const nick = nickEl.value.trim() || "Guest";
      if(text){
        push(chatRef,{ name:nick, msg:text, time:Date.now() });
        msgEl.value = "";
      }
    };
    msgEl.addEventListener("keydown", e=>{ if(e.key==="Enter") sendBtn.click(); });

    // Load messages live
    onChildAdded(chatRef,(snap)=>{
      const d = snap.val();
      const div = document.createElement("div");
      div.className="msg";
      div.innerHTML = `<strong>${d.name}:</strong> ${d.msg}`;
      chatEl.appendChild(div);
      chatEl.scrollTop = chatEl.scrollHeight;
    });
  </script>
</body>
      </html>
